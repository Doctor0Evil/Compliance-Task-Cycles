package bithub.security

# Require minimal top-level permissions and concurrency presence
permissions_violation[msg] {
  not input.permissions     # if your loader maps workflow perms here
  msg := "Workflow must declare top-level permissions; escalate per job only."
}

permissions_violation[msg] {
  input.permissions.contents != "write"
  msg := "Humor Bot requires contents: write only (for repository_dispatch)."
}

action_pinning_violation[msg] {
  some u
  u := input.actions[_]
  re_match("@v\\d+(\\.\\d+)?$", u)
  msg := sprintf("Action must be pinned by commit SHA, not tag: %s", [u])
}
