name: Workflow Responder

on:
  workflow_run:
    workflows:
      - Workflow Fixer
      - Workflow Generator
      - Workflow Validator
      - Meta Orchestrator
    types: [ completed ]

permissions:
  contents: write
  pull-requests: write

jobs:
  rescue:
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    runs-on: ubuntu-latest
    steps:
      - name: Invoke Fixer as rescue
        uses: ./.github/workflows/workflow_fixer.yml
        with:
          caller: responder
          depth: 1

  observe-success:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    steps:
      - name: Log success
        run: echo "Observed successful run of ${{ github.event.workflow_run.name }} (#${{ github.event.workflow_run.id }})"
